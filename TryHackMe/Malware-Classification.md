# Malware Classification - TryHackMe

> Learn how to identify, classify, and understand common types of malware

**Room Link:** https://tryhackme.com/room/malwareclassification

<img width="1757" height="884" alt="image" src="https://github.com/user-attachments/assets/f49736b5-565e-49aa-85d9-c128f6bfb515" />


---

## Task 1: Introduction

**Topics:**
- Malware categories
- Real-world examples
- Binary vs script-based threats
- SOC analyst responsibilities

**What is Malware?**

Software designed to:
- Damage systems
- Steal information
- Allow unauthorized access

**Why Classification Matters:**
- Determine correct response
- Isolate infected machines
- Investigate data theft
- Protect organization

**No answer needed**

---

## Task 2: Malware Types

### Common Categories

**Cryptominer:**
- Uses system resources
- Mines cryptocurrency
- High CPU usage

**Ransomware:**
- Encrypts files
- Demands payment
- Blocks access

**Adware:**
- Shows unwanted ads
- Pop-up windows
- Browser hijacking

**Data Stealer:**
- Exfiltrates sensitive data
- Steals credentials
- Leaks information

### Questions

**Q1: Employee reports slow system with high CPU. What malware type?**

Constant resource usage = mining activity.

- Answer: `cryptominer`

---

**Q2: Files locked, message demands crypto payment. Which malware?**

Encryption + ransom demand.

- Answer: `ransomware`

---

**Q3: Browser pop-ups, no data stolen/encrypted. What malware?**

Annoying ads, no real damage.

- Answer: `adware`

---

**Q4: Internal documents posted online. Which malware type?**

Data exfiltration detected.

- Answer: `Data stealer`

---

## Task 3: Real-World Malware Examples

### Notable Families

**Agent Tesla:**
- Keylogger + infostealer
- Captures screenshots
- Steals browser credentials
- Delivered via phishing

**Pegasus:**
- Mobile spyware
- Zero-click exploit
- Monitors calls/messages
- GPS tracking

**Akira:**
- Ransomware family
- Double extortion
- Steals data before encryption
- Threatens to leak

**Shamoon:**
- Destructive wiper
- Targeted energy sector
- Overwrites files with junk
- Data destruction

### Questions

**Q1: Phishing delivers keylogger + credential stealer. Which family?**

- Answer: `Agent Tesla`

---

**Q2: Zero-click mobile spyware monitoring device. What malware?**

- Answer: `Pegasus`

---

**Q3: Ransomware that steals data and threatens leaks?**

Double extortion tactic.

- Answer: `Akira`

---

**Q4: Malware that targeted energy companies, overwrote files?**

Destructive wiper malware.

- Answer: `shamoon`

---

## Task 4: Binary vs Script Malware

### Binary Malware

**Characteristics:**
- Compiled executables
- `.exe`, `.dll`, `.sys` files
- Harder to analyze
- Leaves byte patterns

**Detection:**
- Signature-based AV
- Hash matching
- Behavioral analysis

### Script Malware

**Characteristics:**
- Human-readable code
- PowerShell, Python, Bash
- Easier to modify
- Fileless attacks

**Common tools:**
- PowerShell
- VBScript
- JavaScript
- Batch files

### Questions

**Q1: Command-line tool used by scripts to download payloads?**

Common Windows scripting tool.

- Answer: `PowerShell`

---

**Q2: File extension for Windows executables, other than .exe?**

Batch script files.

- Answer: `.bat`

---

**Q3: Which malware type leaves identifiable byte patterns for AV?**

Compiled executables have signatures.

- Answer: `Binary`

---

## Task 5: Practical

### Hands-On Exercise

Apply knowledge to classify malware samples.

**Q1: What is the flag?**

Complete the practical exercises.

- Answer: `THM{Malwar3_cl4ss1fication_p4ss3d}`

---

## Task 6: Conclusion

**No answer needed**

---

## Quick Reference

### Malware Categories

| Type | Behavior | Impact |
|------|----------|--------|
| **Cryptominer** | High CPU usage | Resource drain |
| **Ransomware** | File encryption | Data hostage |
| **Adware** | Pop-ups/ads | Annoyance |
| **Data Stealer** | Exfiltration | Data breach |
| **Keylogger** | Keystroke logging | Credential theft |
| **Wiper** | File destruction | Permanent loss |
| **Spyware** | Surveillance | Privacy breach |

### Real-World Examples

**Agent Tesla:**
- Infostealer + keylogger
- Phishing delivery
- Steals credentials

**Pegasus:**
- Mobile surveillance
- Zero-click exploit
- Government-grade spyware

**Akira:**
- Double extortion ransomware
- Data theft + encryption
- Leak threats

**Shamoon:**
- Destructive wiper
- Energy sector target
- File overwriting

### Binary vs Script

**Binary:**
```
✓ Compiled code
✓ Signature detection
✓ .exe, .dll files
✓ Byte patterns
```

**Script:**
```
✓ Human-readable
✓ PowerShell, Python
✓ Fileless attacks
✓ Easy modification
```

### Detection Methods

**Indicators:**
- High CPU usage (cryptominer)
- File encryption (ransomware)
- Pop-up ads (adware)
- Data exfiltration (stealer)
- PowerShell activity (script)

**Analysis:**
- Check process tree
- Monitor network traffic
- Review file modifications
- Analyze scripts/binaries

---

## Key Takeaways

- **Classification** determines response
- **Cryptominers** drain resources
- **Ransomware** encrypts for payment
- **Adware** shows unwanted ads
- **Data stealers** exfiltrate info
- **Agent Tesla** logs keystrokes
- **Pegasus** is mobile spyware
- **Akira** uses double extortion
- **Shamoon** destroys data
- **PowerShell** common in scripts
- **Binary malware** has signatures
- **Script malware** easier to modify
- **Know your malware** types

Happy hunting
